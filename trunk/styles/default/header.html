<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="{dir}">
<!-- Powered by kleeja || URL www.kleeja.com -->
<head>
	<title>{title}(title? &#9679; :){config.sitename}</title>
	<meta http-equiv="Content-Type" content="text/html;charset={charset}" />
	<meta http-equiv="Content-Language" content="{lang.LANG_SMALL_NAME}" />
	<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
	<meta name="copyrights" content="Powered by Kleeja || kleeja.com" />
	<!-- metatags.info/all_meta_tags -->
	<link rel="shortcut icon" href="images/favicon.ico" />
	<link rel="icon" type="image/gif" href="images/favicon.gif" />
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png" />
	<link rel="apple-touch-startup-image" href="images/iPhone.png" />
	<link rel="stylesheet" type="text/css" media="all" href="{STYLE_PATH}css/stylesheet.css" />
	<IS_BROWSER!="mobile">
	<link rel="stylesheet" type="text/css" media="all" href="{STYLE_PATH}css/color.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="{STYLE_PATH_ADMIN}css/facebox.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="{STYLE_PATH_ADMIN}js/tipsy/tipsy.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="{STYLE_PATH_ADMIN}css/pop.css" />
	<IF NAME="{lang.DIR}==ltr"><link rel="stylesheet" type="text/css" media="all" href="{STYLE_PATH}css/ltr.css" /></IF>
	<IS_BROWSER="ie6"><link rel="stylesheet" type="text/css" media="all" href="{STYLE_PATH}css/ie_6.css" /><style type="text/css">.logo, #main, .title, .pngfix { behavior: url('{STYLE_PATH}ie/iepngfix.htc')};	</style></IS_BROWSER>
	<IS_BROWSER="ie"><link rel="stylesheet" type="text/css" media="all" href="{STYLE_PATH}css/ie.css" /><style type="text/css">.border_radius {behavior: url('{STYLE_PATH}ie/css3.htc')}</style></IS_BROWSER>
	<script type="text/javascript" src="{STYLE_PATH_ADMIN}js/jquery.min.js"></script>
    <script type="text/javascript" src="{STYLE_PATH_ADMIN}js/facebox.js"></script>
    <script type="text/javascript" src="{STYLE_PATH_ADMIN}js/tipsy/tipsy.js"></script>
    <script type="text/javascript" src="http://127.0.0.1/kleeja/admin/toffee/js/jquery.pop.js"></script>
	<script type="text/javascript">
<!--//
jQuery(document).ready(function($){
	$.pop();
	$('a[title]').tipsy({gravity: $.fn.tipsy.autoNS});
	$('a[rel*=facebox]').facebox();

	//for # in address bar
	hash = window.location.hash.replace('#!', '');
	where_are_we = hash.match(/cp\=([0-9a-z_]+)/);
	if(!where_are_we){
		where_are_we = 'index';
	}else{
		where_are_we = where_are_we[1];
	}

	console.debug('where_are_we='+where_are_we);
	//for go menu
	if(where_are_we != 'php_info'){
		div_id = $('div[goto='+ where_are_we +']').attr('id');
		gomenu_id = $("div[goto='"+ where_are_we +"']").attr('gomenu_id');
		if(gomenu_id){
			gomenu_id = gomenu_id.replace(/^\s+|\s+$/g,"");
		}
	}else if(where_are_we == 'php_info'){
		div_id = 'menu_item1'; gomenu_id = '1';
	}

	console.debug('div_id='+div_id);
	console.debug('gomenu_id='+gomenu_id);	
	//if(hash != '')
	//{
		//alert(hash)
	get_kleeja_link('./?' + hash, '#content', {'current_id':div_id, 'current_class':'link_current', 'gomenu_id':gomenu_id});
	//}
	
});

function get_kleeja_link(URL, ID, p)
{
	if(!p){
		p = {};
	}

	if(!ID){
		ID = '#content';
	}

	$("#sign_ajax_error").css('display', 'none');

	if(p['confirm']){
		if(!confirm_from()){
			return;
		}
	}

	//$(ID).css('display', 'none');
	$(ID).addClass('show_less');
	
	if(URL.indexOf('?') == -1){
		URL += '?';
	}
	
	window.location.hash = '!' + URL.replace('&amp;', '&').split('?', 2)[1];
	if(window.location.hash.indexOf('formkey') != -1){
		window.location.hash = window.location.hash.replace(/&formkey=[a-z0-9]+/, '');
	}

	$("#sign_ajax").show();

	$.ajax({
		url: URL.replace('&amp;', '&') + '&_ajax_=1',
		cache: false,
		dataType: 'json',
		success: function(R){
			
			$("#sign_ajax").css('display', 'none');

			//not login 
			if(R.code == 999){
				location.href = './';
			} else if(R.code == 888) {
				alert(R.content);
				get_kleeja_link(URL, ID);
				return;
			} else {
				$(ID).html(R.content);

				if(p['current_id']){
					$('.' + p['current_class']).removeClass(p['current_class']);
					$('#' + p['current_id']).addClass(p['current_class']);
				}

				$(ID).removeClass('show_less');
				$(ID).fadeIn(100);

				if($('body').scrollTop() > 0 && $('body').scrollTop() > 200){
					$('body').animate({scrollTop:0}, 'slow');
				} else if($('html').scrollTop() > 0 && $('html').scrollTop() > 230){
					$('html').animate({scrollTop:0}, 'slow');
				}

				if(p['gomenu_id']) {
					$('.go_menu').html('').fadeOut("slow")
					if(R.menu) {
						$('#gomenu'+p['gomenu_id']).html(R.menu).fadeIn("slow");
					}
				} else {
					if(R.menu) {
						$("div[class='link_current']").html(R.menu).fadeIn("slow");
					}
				}
			}
		},
		error : function(R){
			//$(ID).html('----');
			$("#sign_ajax").css('display', 'none');
			$("#sign_ajax_error").show();
		}
	});
}

function submit_kleeja_data(FORM_ID, ID, CONFIRM)
{
	if(!ID){
		ID = '#content';
	}

	if(CONFIRM){
		if(!confirm_from()){
			return;
		}
	}
	
	URL = $(FORM_ID).attr('action');
	if(URL.indexOf('?') == -1){
		URL += '?';
	}
	window.location.hash = '!' + URL.replace('&amp;', '&').split('?', 2)[1];
	if(window.location.hash.indexOf('formkey') != -1){
		window.location.hash = window.location.hash.replace(/&formkey=[a-z0-9]+/, '');
	}

	$("#sign_ajax_error").css('display', 'none');
	//$(ID).css('display', 'none');
	$(ID).addClass('show_less');
	$("#sign_ajax").show();
	
	$.ajax({
		type: 'POST',
		url: URL.replace('&amp;', '&') + '&_ajax_=1',
		data: $(FORM_ID).serialize(),
		cache: false,
		dataType: 'json',
		success: function(R){
			
			$("#sign_ajax").css('display', 'none');
			
			//not login 
			if(R.code == 999){
				location.href = './';
			}else if(R.code == 888){
				if(R.content != ''){
					alert(R.content);
				}
				get_kleeja_link($(FORM_ID).attr('action'), ID);
				return;
			}else{
				$(ID).html(R.content);
				$(ID).removeClass('show_less');
				$(ID).fadeIn(100);
				if($('body').scrollTop() > 0 && $('body').scrollTop() > 200){
					$('body').animate({scrollTop:0}, 'slow');
				}else if($('html').scrollTop() > 0 && $('html').scrollTop() > 230){
					$('html').animate({scrollTop:0}, 'slow');
				}
				
				if(p['gomenu_id']){
					$('.go_menu').html('').fadeOut("slow")
					if(R.menu){
						$('#gomenu'+p['gomenu_id']).html(R.menu).fadeIn("slow");
					}
				}else{
					if(R.menu){
						$("div[class='link_current']").html(R.menu).fadeIn("slow");
					}
				}
			}
		},
		error : function(R){
			//$(ID).html('----');
			$("#sign_ajax").css('display', 'none');
			$("#sign_ajax_error").show();
		}
	});
}

function change_color(obj, id, c, c2) {
    c = (c == null) ? 'ored' : c;
    c2 = (c == null) ? 'osilver' : c2;
    var ii = document.getElementById(id);
    if (obj.checked) {
        ii.setAttribute("class", c);
        ii.setAttribute("className", c)
    } else {
        ii.setAttribute("class", c2);
        ii.setAttribute("className", c2)
    }
}
function checkAll(form, id, _do_c_, c, c2) {
    for (var i = 0; i < form.elements.length; i++) {
        if (form.elements[i].getAttribute("rel") != id) continue;
        if (form.elements[i].checked) {
            uncheckAll(form, id, _do_c_, c, c2);
            break
        }
        form.elements[i].checked = true;
        change_color(form.elements[i], _do_c_ + '[' + form.elements[i].value + ']', c, c2)
    }
}
function uncheckAll(form, id, _do_c_, c, c2) {
    for (var i = 0; i < form.elements.length; i++) {
        if (form.elements[i].getAttribute("rel") != id) continue;
        form.elements[i].checked = false;
        change_color(form.elements[i], _do_c_ + '[' + form.elements[i].value + ']', c, c2)
    }
}
function change_color_exts(id) {
    eval('var ii = document.getElementById("su[' + id + ']");');
    eval('var g_obj = document.getElementById("gal_' + id + '");');
    eval('var u_obj = document.getElementById("ual_' + id + '");');
    if (g_obj.checked && u_obj.checked) {
        ii.setAttribute("class", 'o_all');
        ii.setAttribute("className", 'o_all')
    } else if (g_obj.checked) {
        ii.setAttribute("class", 'o_g');
        ii.setAttribute("className", 'o_g')
    } else if (u_obj.checked) {
        ii.setAttribute("class", 'o_u');
        ii.setAttribute("className", 'o_u')
    } else {
        ii.setAttribute("class", '');
        ii.setAttribute("className", '')
    }
}
function checkAll_exts(form, id, _do_c_) {
    for (var i = 0; i < form.elements.length; i++) {
        if (form.elements[i].getAttribute("rel") != id) continue;
        if (form.elements[i].checked) {
            uncheckAll_exts(form, id, _do_c_);
            break
        }
        form.elements[i].checked = true;
        change_color_exts(form.elements[i].value)
    }
}
function uncheckAll_exts(form, id, _do_c_) {
    for (var i = 0; i < form.elements.length; i++) {
        if (form.elements[i].getAttribute("rel") != id) continue;
        form.elements[i].checked = false;
        change_color_exts(form.elements[i].value)
    }
}
//-->
</script>
	<script type="text/javascript">
	<!--
	document.write('<link rel="stylesheet" type="text/css" media="all" href="{STYLE_PATH}css/css3.css" />');
	-->
	</script>
	<ELSE>
	<link rel="stylesheet" type="text/css" href="{STYLE_PATH}css/mobile.css"  />
	</IS_BROWSER>
	<script type="text/javascript">
	<!--
	var number_of_uploads={config.filesnum};
	var LANG_PAST_URL_HERE = "{lang.PAST_URL_HERE}";
	var LANG_MORE_F_FILES = "{lang.MORE_F_FILES}";
	var STYLE_PATH  = "{STYLE_PATH}";
	-->
	</script>
	<script type="text/javascript" src="{STYLE_PATH}javascript.js"></script>
	<!-- Extra code -->
	{EXTRA_CODE_META}
</head>
<body>
<!-- begin Main -->
<div id="main">

	<!--begin Header-->
	<div id="header" class="clearfix">
		<h1><a title="{config.sitename}" href="{config.siteurl}" class="logo">{config.sitename}</a></h1>
	</div>
	<!-- @end-Header -->

	<div class="clr"></div>

	<!-- begin Top Navigation -->
	<div class="top_nav">
		<ul class="menu">
		<LOOP NAME="top_menu"><IF LOOP="show">
		<li><a href="{{url}}" (go_current=={{name}}?class="current":)>{{title}}</a></li>
		</IF></LOOP>
		</ul>
	</div><!-- @end-Top-Navigation -->

	<div class="clr"></div>

	<!-- begin wrapper -->
	<div id="wrapper" class="clearfix">

	<IF NAME="extras.header">
	<!-- begin extras header -->
	<div class="dot"></div>
		<div class="extras_header">{extras.header}</div>
	<div class="dot"></div>
	<!-- @end-extras-header -->
	</IF>

	<div class="clr"></div>

	<!-- begin menu right -->
	<div id="right_menu">
		<div class="list">
			<ul>
				<li class="imgtop">&nbsp;</li>
				<LOOP NAME="side_menu"><IF LOOP="show">
				<li><a href="{{url}}" (go_current=={{name}}?class="current":)><img src="{STYLE_PATH}images/{{name}}.png" class="pngfix" alt="{lang.LOGIN}" style="vertical-align:middle;" />{{title}} <IF LOOP="name==logout">[ {username} ]</IF></a></li>
				</IF></LOOP>
				<li class="imgbottom">&nbsp;</li>
			</ul>
		</div>
		<div class="clr"></div>
		<div class="css_xhtml">
			<a class="xhtml" title="Valid XHTML" onclick="window.open(this.href,'_blank');return false;" href="http://validator.w3.org/check?uri=referer"><img src="{STYLE_PATH}images/xhtml.gif" alt="Valid XHTML" /></a>
			<a class="css" title="CSS" onclick="window.open(this.href,'_blank');return false;" href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3"><img src="{STYLE_PATH}images/css.gif" alt="CSS" /></a>
		</div>
	</div><!-- @end-menu-right -->
